
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Copilot AI</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
        background-color: #f5f5f5;
        display: flex;
        flex-direction: column;
        height: 100vh;
        position: relative;
      }
      .online-status {
        position: absolute;
        top: 40px;
        left: 0;
        width: 100%;
        background-color: #f5f5f5;
        color: #a767e5;
        text-align: center;
        padding: 5px 0;
        font-size: 12px;
        z-index: 6;
      }
      .copilot-header {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        background-color: white;
        color: #a767e5;
        text-align: center;
        padding: 7px 0;
        font-size: 18px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        z-index: 2.5;
      }
      .chat-container {
        width: 90%;
        max-width: 680px;
        padding: 15px;
        background: linear-gradient(135deg, #f59de8, #a767e5);
        border-radius: 3px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        flex-grow: 1;
        overflow-y: auto;
        color: white;
        margin-top: 60px;
      }
      .message {
        margin: 10px 0;
        padding: 10px;
        border-radius: 20px;
        max-width: 40%;
        word-wrap: break-word;
        background-color: rgba(255, 255, 255, 0.3);
        position: relative;
      }
      .message.user {
        margin-left: auto;
        text-align: right;
      }
      .message.bot {
        margin-right: auto;
      }
      .read-status {
        position: absolute;
        bottom: -15px;
        right: 0;
        color: white;
        font-size: 14px;
      }
      .input-container {
        width: 100%;
        max-width: 600px;
        margin-top: 10px;
        display: flex;
        justify-content: center;
      }
      .input-container input {
        padding: 10px;
        flex-grow: 1;
        border: none;
        border-radius: 7px 0 0 7px;
        font-size: 14px;
      }
      .input-container button {
        padding: 10px;
        border: none;
        background-color: #a767e5;
        color: white;
        border-radius: 0 7px 7px 0;
        font-size: 14px;
        cursor: pointer;
      }
      .thinking {
        background-color: rgba(255, 255, 255, 0.3);
        font-style: italic;
        color: #6c757d;
        margin-right: auto;
      }
    </style>
</head>
<body>
<div class="copilot-header">Copilot AI</div>
<div class="online-status">在线</div>
<div class="chat-container" id="chat"></div>

<div class="input-container">
  <input type="text" id="userInput" placeholder="输入你的消息..." onkeypress="handleKeyPress(event)">
  <button id="sendButton">发送</button>
</div>

<script>
// 初始化消息
window.onload = function() {
    const initMessage = createMessage(
        ' 您好, 我是 Mbilse-Copilot AI 3.0.25-正式版 ,我可以帮你写作，解说， 我还可以与你一起聊天哦！', 
        'bot',
        true
    );
    document.getElementById("chat").appendChild(initMessage);
    scrollToBottom();
};

function handleKeyPress(event) {
    if (event.key === 'Enter') submitInput();
}

document.getElementById("sendButton").onclick = submitInput;

function submitInput() {
    const userInput = document.getElementById("userInput").value.trim();
    if (!userInput) return;

    // 显示用户消息（立即添加已送达）
    const chatDiv = document.getElementById("chat");
    const userMessage = createMessage(userInput, 'user');
    chatDiv.appendChild(userMessage);
    addDeliveryStatus(userMessage);
    scrollToBottom();

    // 显示正在思考
    const thinkingMessage = createMessage('Thinking...', 'bot');
    thinkingMessage.classList.add('thinking');
    chatDiv.appendChild(thinkingMessage);
    scrollToBottom();

    // 调用API
    fetch(`https://api.52vmy.cn/api/chat/spark?msg=${encodeURIComponent(userInput)}`)
        .then(response => response.json())
        .then(data => {
            chatDiv.removeChild(thinkingMessage);
            const aiResponse = data.data?.answer || "抱歉，由于api请求限制，我们无法成功服务您，请稍后再试。";
            typeMessage(aiResponse, 'bot');
        })
        .catch(error => {
            console.error('Error:', error);
            chatDiv.removeChild(thinkingMessage);
            typeMessage('出现错误，请稍后再试。', 'bot');
        });

    document.getElementById("userInput").value = "";
}

function createMessage(text, type, immediate = false) {
    const div = document.createElement('div');
    div.className = `message ${type}`;
    div.textContent = `${type === 'user' ? '' : ''}${text}`;
    
    // 初始化消息直接添加已读状态
    if (immediate && type === 'bot') {
        addReadStatus(div);
    }
    return div;
}

function typeMessage(text, type) {
    const chatDiv = document.getElementById("chat");
    const messageDiv = createMessage('', type);
    chatDiv.appendChild(messageDiv);
    
    let index = 0;
    const typing = setInterval(() => {
        if (index < text.length) {
            messageDiv.textContent = `${text.substring(0, index + 1)}`;
            scrollToBottom();
            index++;
        } else {
            clearInterval(typing);
            addReadStatus(messageDiv); // 添加已读状态
        }
    }, 25);
}

// 添加已送达状态
function addDeliveryStatus(messageElement) {
    const status = document.createElement('div');
    status.className = 'read-status';
    status.textContent = '已送达';
    messageElement.appendChild(status);
}

// 添加已读状态
function addReadStatus(messageElement) {
    const status = document.createElement('div');
    status.className = 'read-status';
    status.textContent = '已读';
    messageElement.appendChild(status);
    scrollToBottom();
}

function scrollToBottom() {
    const chat = document.getElementById("chat");
    chat.scrollTop = chat.scrollHeight;
}
</script>
</body>
</html>r;
  }
</style>
  <meta name="msvalidate.01" content="D3E0694DAAE374BCED74213494D74D18" />
</head>
  
<body>

<div class="copilot-header">Copilot AI</div> <!-- 浮动的白色横条 -->
<div class="online-status">在线</div>
<div class="chat-container" id="chatContainer"></div>

<div class="input-container">
  <input type="text" id="userInput" placeholder="在这里输入内容..." onkeypress="handleKeyPress(event)">
  <button onclick="submitInput()">发送</button>
</div>

<script>
  function handleKeyPress(event) {
    if (event.key === 'Enter') {
      submitInput();
    }
  }
window.onload = function() {
    // 调用displayMessage函数显示初始消息
    displayMessage('Hello, My name is Copilot AI 3.0, I can do anything. Input help to help.', 'bot');
  };
  function submitInput() {
    const input = document.getElementById('userInput').value.trim();
    if (input) {
      displayMessage(input, 'user');
      const response = getResponse(input);
      typeMessage(response, 'bot');
      document.getElementById('userInput').value = ''; // 清空输入框
    }
  }

  function displayMessage(text, type) {
    const messageElement = document.createElement('div');
    messageElement.classList.add('message', type);
    messageElement.textContent = text;
    document.getElementById('chatContainer').appendChild(messageElement);
    const readStatus = document.createElement('div');
    readStatus.textContent = '已送达';
    readStatus.classList.add('read-status');
    messageElement.appendChild(readStatus);
    scrollToBottom();
  }

  function getResponse(input) {
    const lowerInput = input.toLowerCase();
    if (lowerInput === '你好' || lowerInput === '你好！' || lowerInput === 'Hi' || lowerInput === 'Hi!' || lowerInput === 'hi' || lowerInput === 'Hello' || lowerInput === 'hello') {
      return 'Hello!';
    } else if (lowerInput === '再见' || lowerInput === 'bye') {
      return 'Bye!';
    } else if (lowerInput === '请问' || lowerInput === '如何') {
      return '呃......请说';
    } else if (lowerInput === 'html' || lowerInput === '一个html') {
      return '以下是一个html示例：\n<!doctype html>\n<html>\n  <head>\n    <title>my</title>\n  </head>\n<body>\n</body>\n</html>-----------------------------------代码总结：DOCTYPE是声明html5文件的，<html>是html起始，此文件包含了一个页面title,body,head......，你可以加上script和style用来设置js与css。';
    } else if (lowerInput === 'Name' || lowerInput === 'name' || lowerInput === '名字') {
      return 'My name is Copilot AI.';
    }else if (lowerInput === 'help' || lowerInput === '帮助') {
      return '帮助信息：发点：在线问候，发name：名字，发html：html示例，发hello和bye：用于问候，请问：用于咨询问题，Version：用于咨询版本。早上好：问候。';
    } else if (lowerInput === 'Version' || lowerInput === 'version' || lowerInput === '版本') {
      return 'My Version is 3.0';
    } else if (lowerInput === '.' || lowerInput === '。') {
      return '我一直在线哦，您是不是不知道想发什么了，发help让我帮助你！';
    }else if (lowerInput === '早上好！' || lowerInput === '早上好' || lowerInput === 'morning' ||lowerInput === 'Morning') {
      return 'Good morning!';
    } else {
      return 'A error for input.';
    }
  }

  function typeMessage(text, type) {
    let index = 0;
    const messageElement = document.createElement('div');
    messageElement.classList.add('message', type);
    document.getElementById('chatContainer').appendChild(messageElement);
    const interval = setInterval(() => {
      if (index < text.length) {
        messageElement.textContent += text[index++];
      } else {
        clearInterval(interval);
        const readStatus = document.createElement('div');
        readStatus.textContent = '已读';
        readStatus.classList.add('read-status');
        messageElement.appendChild(readStatus);
        scrollToBottom();
      }
    }, 125);
  }

  function scrollToBottom() {
    const chatContainer = document.getElementById('chatContainer');
    chatContainer.scrollTop = chatContainer.scrollHeight;
  }
</script>

</body>
</html>
